import{_ as V}from"./AuthenticatedLayout.e202d503.js";import{_ as E,a as S}from"./TextInput.354c703c.js";import{D as f,o as d,g as h,a as l,w as c,F as x,d as a,K as b,f as L,x as B,k as N}from"./app.df7a48ba.js";import{D as C,_ as I}from"./green_table.d6e09b8e.js";import{e as A}from"./vue-basic-alert.esm.a6fa098a.js";import{_ as X}from"./_plugin-vue_export-helper.cdc0426e.js";import"./ApplicationLogo.13c20baa.js";import"./mqtt.min.77c8ccfe.js";const Y="/build/assets/green_table2.ede7a3ad.png";const z={components:{BreezeAuthenticatedLayout:V,BreezeLabel:E,BreezeInput:S,Modal:C,VueBasicAlert:A},data(){return{tags:[1,2,3],InfoList:[],restList:[],rest_id:"",rest_x:"",rest_y:"",height:0,show_move_area:!1,offTop:0,offTop:0,isVisible:!1,capacity:0,robot_id:"",counter:1,buttonTop:150,editingTableId:"",msg:"",isExist:!1}},created(){window.addEventListener("scroll",this.handleScroll),axios.get("/getRest").then(t=>{console.log(t),this.restList=t.data.rests})},destroyed(){window.removeEventListener("scroll",this.handleScroll)},mounted(){this.GetElementDistance()},methods:{dragStart(t){let e={id:t.target.id,isDrop:!0};t.dataTransfer.setData("Text",JSON.stringify(e)),this.offsetX=t.offsetX,this.offsetY=t.offsetY},dragEnd(t){console.log("done"),t.dataTransfer.clearData()},drop(t){let e=JSON.parse(t.dataTransfer.getData("Text"));e.isDrop&&(e.x=t.clientX-this.offsetX-this.offLeft,e.y=t.clientY-this.offsetY-this.offTop,e.tblImg=!0,e.id="table"+this.counter,this.InfoList.push(e),this.counter++)},imgStart(t){let e={isDrop:!1};t.dataTransfer.setData("Text",JSON.stringify(e)),this.imgOffsetX=t.offsetX,this.imgOffsetY=t.offsetY},imgDragging(t,e){if(this.canOut)e.x=t.clientX-this.imgOffsetX-this.offLeft,e.y=t.clientY-this.imgOffsetY-this.offTop;else{const r=this.$refs.moveArea,_=t.clientX,o=t.clientY,s=r.offsetLeft+this.offLeft,m=r.offsetTop+this.offTop,p=s+r.offsetWidth,u=m+r.offsetHeight;_>=s&&_<=p&&o>=m&&o<=u&&(e.x=t.clientX-this.imgOffsetX-this.offLeft,e.y=t.clientY-this.imgOffsetY-this.offTop)}},ondrag(t){console.log("")},input_area(){this.rest_x&&this.rest_y?(this.show_move_area=!0,this.height=Number(this.rest_y)):this.show_move_area=!1},GetElementDistance(){var t=document.getElementById("movearea");t&&(this.offTop=t.getBoundingClientRect().top-50,this.offLeft=t.getBoundingClientRect().left-20)},inputTableInfo(){this.assignValueToInfoList(this.editingTableId,"","",this.capacity,this.robot_id),console.log("done"),this.isVisible=!1},showPopUp(t){this.isVisible=!0,this.editingTableId=t,this.capacity=0,this.robot_id=""},handleScroll(){this.GetElementDistance()},assignValueToInfoList(t,e,r,_,o){for(let s=0;s<this.InfoList.length;s++)this.InfoList[s].id==t&&(e&&(this.InfoList[s].x=e),r&&(this.InfoList[s].y=r),_&&(this.InfoList[s].capacity=_),o&&(this.InfoList[s].robot_id=o),this.InfoList[s].capacity&&this.InfoList[s].robot_id&&(this.InfoList[s].tblImg=!1))},submit(){if(this.msg=this.validate(),this.msg)this.$refs.alert.showAlert("error",this.msg,"Error!","Error 200");else{axios.post("/createRest",{rest_id:this.rest_id,rest_x:this.rest_x,rest_y:this.rest_y}).then(t=>{this.$refs.alert.showAlert("success",t.data.message,"success!","Success 200")});for(let t=0;t<this.InfoList.length;t++)axios.post("/createTable",{table_no:this.InfoList[t].id,rest_id:this.rest_id,capacity:this.InfoList[t].capacity,table_x:this.InfoList[t].x,table_y:this.InfoList[t].y,status:"ACTIVE",robot_id:this.InfoList[t].robot_id}).then(e=>{console.log(e)})}},validate(){if(!this.rest_id)return"Missing restaurant name.";if(!this.rest_x||!this.rest_y)return"Missing width or height.";for(let t=0;t<this.InfoList.length;t++)if(!this.InfoList[t].capacity||!this.InfoList[t].robot_id)return"Please double click robot and input Capacity or robot name for "+this.InfoList[t].id;return""},check_rest(){this.InfoList=[];for(let t=0;t<this.restList.length;t++)this.restList[t].rest_id==this.rest_id&&(this.isExist=!0,this.show_move_area=!0,this.rest_x=this.restList[t].rest_x,this.rest_y=this.restList[t].rest_y,this.height=Number(this.restList[t].rest_y),axios.post("/getTable",{rest_id:this.rest_id}).then(e=>{for(let r=0;r<e.data.tables.length;r++)this.InfoList.push({x:e.data.tables[r].table_x,y:e.data.tables[r].table_y,capacity:e.data.tables[r].capacity,robot_id:e.data.tables[r].robot_id,id:e.data.tables[r].table_no,status:e.data.tables[r].status}),this.counter++}))},update(){if(this.msg=this.validate(),this.msg)this.$refs.alert.showAlert("error",this.msg,"Error!","Error 200");else{axios.post("/updateRest",{rest_id:this.rest_id,rest_x:this.rest_x,rest_y:this.rest_y}).then(t=>{console.log(t.data.message),this.$refs.alert.showAlert("success",t.data.message,"success!","Success 200")});for(let t=0;t<this.InfoList.length;t++)console.log(this.InfoList[t]),axios.post("/delTable",{rest_id:this.rest_id,table_no:this.InfoList[t].id}).then(e=>{console.log("test this.InfoList.id"),console.log(this.InfoList[t].id),this.InfoList[t].status||(this.InfoList[t].status="ACTIVE"),axios.post("/createTable",{table_no:this.InfoList[t].id,rest_id:this.rest_id,capacity:this.InfoList[t].capacity,table_x:this.InfoList[t].x,table_y:this.InfoList[t].y,status:this.InfoList[t].status,robot_id:this.InfoList[t].robot_id}).then(r=>{console.log(r)})})}},del(){axios.post("/delRest",{rest_id:this.rest_id}).then(t=>{this.$refs.alert.showAlert("success",t.data.message,"success!","Success 200")});for(let t=0;t<this.InfoList.length;t++)console.log(this.InfoList[t]),axios.post("/delTable",{rest_id:this.rest_id,table_no:this.InfoList[t].id}).then(e=>{this.refresh()})},refresh(){this.InfoList=[],this.restList=[],this.rest_id="",this.rest_x="",this.rest_y="",this.height=0,this.show_move_area=!1,this.isVisible=!1,this.editingTableId="",this.isExist=!1}}},O=a("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Please Edit the tables in the Restaurant ",-1),U={class:"py-12"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},j={class:"p-6 bg-white border-b border-gray-200"},M=a("div",{className:"flex items-center justify-between mb-6"}," 1. Please input the restaurant name ",-1),K={className:"flex items-center justify-between mb-6"},G=a("div",{className:"flex items-center justify-between mb-6"}," 2. Please input the restaurant length and width ",-1),H={className:"flex items-center mb-6"},J={className:"flex items-center mb-6"},F=a("div",{className:"flex items-center justify-between mb-6"}," 3. Please drag and drop the table ",-1),W={class:"drag"},q=["id"],Q={key:0},Z=["id","onDrag","onDblclick"],$={key:1},tt=["id","onDrag","onDblclick"],et={key:0},st={key:1};function it(t,e,r,_,o,s){const m=f("Head"),p=f("vue-basic-alert"),u=f("BreezeInput"),g=f("BreezeLabel"),v=f("el-aside"),w=f("el-container"),D=f("el-main"),T=f("Modal"),k=f("BreezeAuthenticatedLayout");return d(),h(x,null,[l(m,{title:"Dashboard"}),l(k,null,{header:c(()=>[O]),default:c(()=>[l(p,{duration:1500,closeIn:5e3,ref:"alert"},null,512),a("div",U,[a("div",P,[a("div",R,[a("div",j,[M,a("div",K,[l(u,{id:"rest_id",type:"text",class:"mt-1 block w-50",modelValue:o.rest_id,"onUpdate:modelValue":e[0]||(e[0]=i=>o.rest_id=i),onChange:s.check_rest,autofocus:""},null,8,["modelValue","onChange"])]),G,a("div",H,[l(g,{value:"width(ft)"}),l(u,{id:"rest_x",type:"text",class:"mt-1 block w-40",modelValue:o.rest_x,"onUpdate:modelValue":e[1]||(e[1]=i=>o.rest_x=i),onKeyup:s.input_area,autofocus:""},null,8,["modelValue","onKeyup"])]),a("div",J,[l(g,{value:"height(ft)"}),l(u,{id:"rest_y",type:"text",class:"mt-1 block w-40",onKeyup:s.input_area,modelValue:o.rest_y,"onUpdate:modelValue":e[2]||(e[2]=i=>o.rest_y=i),autofocus:""},null,8,["onKeyup","modelValue"])]),F,a("div",null,[a("div",W,[l(w,null,{default:c(()=>[l(v,{width:"300px"},{default:c(()=>[a("ul",null,[a("img",{class:"table_icon",src:I,onDragstart:e[3]||(e[3]=(...i)=>s.dragStart&&s.dragStart(...i)),draggable:"true",id:t.item,onDragend:e[4]||(e[4]=(...i)=>s.dragEnd&&s.dragEnd(...i)),onDrag:e[5]||(e[5]=(...i)=>s.ondrag&&s.ondrag(...i))},null,40,q)])]),_:1})]),_:1}),a("div",null,[l(D,null,{default:c(()=>[o.show_move_area?(d(),h("div",{key:0,id:"movearea",style:b({width:o.rest_x+"px",height:o.rest_y+"px"}),onDrop:e[10]||(e[10]=L((...i)=>s.drop&&s.drop(...i),["prevent"])),onDragover:e[11]||(e[11]=L(()=>{},["prevent"])),ref:"moveArea",class:"move-area"},[(d(!0),h(x,null,B(o.InfoList,(i,y)=>(d(),h("div",{key:y},[i.tblImg?(d(),h("div",Q,[(d(),h("img",{src:I,class:"msg1",id:i.id,style:b({left:i.x+"px",top:i.y+"px"}),key:y,draggable:"true",onDragstart:e[6]||(e[6]=(...n)=>s.imgStart&&s.imgStart(...n)),onDrag:n=>s.imgDragging(n,i),onDblclick:n=>s.showPopUp(i.id),onDragend:e[7]||(e[7]=(...n)=>s.dragEnd&&s.dragEnd(...n))},null,44,Z))])):(d(),h("div",$,[(d(),h("img",{src:Y,class:"msg1",id:i.id,style:b({left:i.x+"px",top:i.y+"px"}),key:y,draggable:"true",onDragstart:e[8]||(e[8]=(...n)=>s.imgStart&&s.imgStart(...n)),onDrag:n=>s.imgDragging(n,i),onDblclick:n=>s.showPopUp(i.id),onDragend:e[9]||(e[9]=(...n)=>s.dragEnd&&s.dragEnd(...n))},null,44,tt))]))]))),128))],36)):N("",!0)]),_:1})])])]),a("div",{className:"flex items-center justify-between mb-6",style:b({"margin-top":o.buttonTop+o.height+"px"})},[o.isExist?(d(),h("div",et,[a("button",{onClick:e[12]||(e[12]=i=>s.update()),tabIndex:"-1",type:"submit",className:"px-6 py-2 font-bold text-white bg-green-500 rounded"}," Update "),a("button",{onClick:e[13]||(e[13]=i=>s.del()),tabIndex:"-1",type:"button",className:"mx-1 px-4 py-2 text-sm text-white bg-red-500 rounded"}," Delete ")])):(d(),h("div",st,[a("button",{onClick:e[14]||(e[14]=i=>s.submit()),tabIndex:"-1",type:"submit",className:"px-6 py-2 font-bold text-white bg-green-500 rounded"}," Submit ")]))],4),l(T,{visible:o.isVisible,"onUpdate:visible":e[17]||(e[17]=i=>o.isVisible=i),title:this.editingTableId+" infomation",okButton:{onclick:()=>{this.inputTableInfo()}}},{default:c(()=>[l(g,{value:"Capacity"}),l(u,{id:"capacity",type:"text",class:"mt-1 block w-40",modelValue:o.capacity,"onUpdate:modelValue":e[15]||(e[15]=i=>o.capacity=i),autofocus:""},null,8,["modelValue"]),l(g,{value:"Robot"}),l(u,{id:"robot_id",type:"text",class:"mt-1 block w-40",modelValue:o.robot_id,"onUpdate:modelValue":e[16]||(e[16]=i=>o.robot_id=i),autofocus:""},null,8,["modelValue"])]),_:1},8,["visible","title","okButton"])])])])])]),_:1})],64)}const ut=X(z,[["render",it]]);export{ut as default};
